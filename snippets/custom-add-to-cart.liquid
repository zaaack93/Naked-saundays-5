<quick-add-product class="quick_add_tocart">
    <div data-quick-add-holder="{{ product.id }}">
      {%- if product.variants.size == 1 -%}
        {%- assign product_form_id = 'ProductForm--' | append: unique -%}
        {%- form 'product', product, id: product_form_id -%}
          <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">

          {%- if sibling_property_value != blank -%}
            <input
              type="hidden"
              name="properties[{{ sibling_property_name }}]"
              value="{{ sibling_property_value }}">
          {%- endif -%}

          {%- if preorder_value != blank -%}
            <input
              type="hidden"
              name="properties[{{ preorder_name }}]"
              value="{{ preorder_value }}">
          {%- endif -%}

          <button class="btn btn--outline btn--primary"
            type="submit"
            name="add"
            data-add-to-cart
          >
            <span class="btn__text">{{ 'products.product.add_to_cart' | t }}</span>
            <span class="btn__added">&nbsp;</span>
            <span class="btn__loader">
              <svg height="18" width="18" class="svg-loader">
                <circle r="7" cx="9" cy="9" />
                <circle stroke-dasharray="87.96459430051421 87.96459430051421" r="7" cx="9" cy="9" />
              </svg>
            </span>
            <span class="btn__error" data-message-error>&nbsp;</span>
          </button>
        {%- endform -%}
      {%- else -%}
        <button class="btn btn--outline btn--primary"
          type="button"
          data-quick-add-btn
          data-quick-add-modal-handle="{{ product.handle }}"
        >
          <span class="btn__text">{{ 'products.product.add_to_cart' | t }}</span>
          <span class="btn__added">&nbsp;</span>
          <span class="btn__loader">
            <svg height="18" width="18" class="svg-loader">
              <circle r="7" cx="9" cy="9" />
              <circle stroke-dasharray="87.96459430051421 87.96459430051421" r="7" cx="9" cy="9" />
            </svg>
          </span>
        </button>
      {%- endif -%}

      {%- unless product.has_only_default_variant -%}
        {%- render 'product-quick-add-modal-template', product_id: product.id, unique: unique -%}
      {%- endunless -%}
    </div>
  </quick-add-product>